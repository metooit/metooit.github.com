<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Rails, | K.I.S.S]]></title>
  <link href="http://metooit.github.com/blog/categories/rails-/atom.xml" rel="self"/>
  <link href="http://metooit.github.com/"/>
  <updated>2013-02-16T20:16:55+08:00</updated>
  <id>http://metooit.github.com/</id>
  <author>
    <name><![CDATA[metooit]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[RailsGuides 阅读笔记]]></title>
    <link href="http://metooit.github.com/blog/2013/02/08/notes-for-reading-the-railsguides/"/>
    <updated>2013-02-08T11:58:00+08:00</updated>
    <id>http://metooit.github.com/blog/2013/02/08/notes-for-reading-the-railsguides</id>
    <content type="html"><![CDATA[<p><a href="http://guides.ruby.tw/rails3/getting_started.html">RailsGuides</a>是Ruby on Rails 官方网站上的一个tutorial， 下面是我通过阅读学习所做的一些笔记。</p>

<hr />

<p>刚刚准备信心满满地开始看得时候，打开网页的第一条是<code>前提条件</code>：好吧，<code>Rails</code>是一套<code>Ruby</code>的web框架，如果对<code>Ruby</code>一无所知就学习<code>Rails</code>，学习曲线会很陡峭。 于是，我决定还是先看一看它提供的文档。</p>

<hr />

<p>继续在这里写吧，昨天看了<code>Ruby</code>的一个教程，初步了解了一下<code>Ruby</code>语言本身， 现在继续看<code>Rails</code>。</p>

<hr />

<h2>1. 什么是<code>Rails</code>：</h2>

<p><code>Ruby</code>的网络开发框架。<code>Rails</code>的原则是：
* DRY
* Convention Over Configuration
* REST</p>

<!-- more -->


<h3>1.1 MVC架构：</h3>

<ul>
<li>Modles: 应用程序的资料和操作资料的逻辑。</li>
<li>Views: 应用程序的使用者界面。</li>
<li>Controllers: M和V之间的粘着剂</li>
</ul>


<h3>1.2 <code>Rails</code>元件：</h3>

<p><a href="http://guides.ruby.tw/rails3/getting_started.html">参见</a></p>

<h3>1.3 REST</h3>

<ul>
<li>在系统部件之间实现资源状态的转换</li>
<li>使用URLs来代表资源（Resourses）</li>
</ul>


<h2>2. 建立Rails项目：</h2>

<ul>
<li>rails new <code>项目名称</code></li>
<li>cd <code>项目名称</code></li>
</ul>


<blockquote><p>注： 每个目录以及文件的作用参见<a href="http://guides.ruby.tw/rails3/getting_started.html">这里</a></p></blockquote>

<ul>
<li>安装必须的<code>gems</code>：这里是一个简单的项目，所以直接 bundle install</li>
<li>设定数据库： 在这个目录下-> <code>config/database.yml</code></li>
<li>建立数据库： rake db:create</li>
</ul>


<blockquote><p>注：<code>rake</code>是<code>Rails</code>中广泛运用的通用型命令行工具。查看所有可用的命令可以<code>rake -T</code>。</p>

<p>这里要记录一个遇到的问题：
我在创建数据库的时候遇到了一个问题：“could not find a javascript runtime”
那么肯定是没有<code>javascript</code>的运行环境了，安装了一个<code>Node.js</code>
安装过程参考<a href="https://github.com/joyent/node">项目主页</a></p></blockquote>

<h2>3. Hello Rails</h2>

<h3>3.1 启动<code>Rails</code>服务器：</h3>

<p><code>rails server</code>启动<code>Mongrel(WEBrick)</code>服务器，当然也可以用其他服务器。</p>

<blockquote><p>浏览器访问 <code>http://localhost:3000</code>,可以看到rails预设的网页。
<img src="/pictures/rails-server-start.png" width="800" height="600" title="rails-server-start rails-server-start" >
关闭服务器的话使用<code>Ctrl-c</code>
如果是production mode的话，修改任何档案都必须重启服务器才会有效果。</p></blockquote>

<h3>3.2 Say "hello" to Rails</h3>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ rails generate controller home index</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>在app/views/home/index.html.erb中加入：
<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>Hello Rails&lt;/h1>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;p></span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>下面设定首页：
* 删除预设的档案：
<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ rm public/index.html</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<ul>
<li>然后， 告诉<code>Rails</code>我真正的首页在哪里：编辑config/routes.rb。</li>
</ul>


<p><img src="/pictures/hello-rails.png" title="hello-rails" ></p>

<h2>4. 使用scaffolding快速上手：</h2>

<h2>5. 建立<code>Resource</code>:</h2>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ rails generate scaffold Post name:string title:string content:text</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><img src="/pictures/scaffold-form.png" title="scaffold-form scaffold-form" ></p>

<ul>
<li><p>然后执行Migration
<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ rake db:migration</span></code></pre></td></tr></table></div></figure></notextile></div>
<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>==  CreatePosts: migrating ====================================================
</span><span class='line'>-- create_table(:posts)
</span><span class='line'> -> 0.0018s
</span><span class='line'>==  CreatePosts: migrated (0.0019s) ===========================================</span></code></pre></td></tr></table></div></figure></notextile></div></p></li>
<li><p>增加超链接： 利用官方的<code>link_to</code>方法来增加一个文章列表的超链接。</p></li>
</ul>


<p><img src="/pictures/link_to.png" title="link_to" ></p>

<p><img src="/pictures/listing-posts.png" title="listing-posts" ></p>

<ul>
<li>新增验证功能： 在<code>app/modles/post.rb</code>中加入如下代码增加了验证功能：</li>
</ul>


<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>class Post &lt; ActiveRecord::Base
</span><span class='line'>  attr_accessible :content, :name, :title&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>  validates :name,  :presence => true
</span><span class='line'>  validates :title, :presence => true,&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>                :length   =&gt; { :minimum =&gt; 5 }
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>end</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><img src="/pictures/validation.png" title="validation" ></p>

<ul>
<li><p>使用Console: console可以在<code>terminal</code>中执行代码。
<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ rails console</span></code></pre></td></tr></table></div></figure></notextile></div></p></li>
<li><p>列出所有文章：
<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>def index
</span><span class='line'>  @posts = Post.all&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>  respond_to do |format|&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>format.html # index.html.erb
</span><span class='line'>format.json { render json: @posts }
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>  end
</span><span class='line'>end</span></code></pre></td></tr></table></div></figure></notextile></div></p></li>
</ul>


<p>其中的<code>@posts</code>在app/views/posts/index.html中：
<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>Listing posts&lt;/h1>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;table>
</span><span class='line'>  &lt;tr>
</span><span class='line'>    &lt;th>Name&lt;/th>
</span><span class='line'>    &lt;th>String&lt;/th>
</span><span class='line'>    &lt;th>Title&lt;/th>
</span><span class='line'>    &lt;th>String&lt;/th>
</span><span class='line'>    &lt;th>Content&lt;/th>
</span><span class='line'>    &lt;th>Text&lt;/th>
</span><span class='line'>    &lt;th>&lt;/th>
</span><span class='line'>    &lt;th>&lt;/th>
</span><span class='line'>    &lt;th>&lt;/th>
</span><span class='line'>  &lt;/tr>
</span><span class='line'>
</span><span class='line'>&lt;% @posts.each do |post| %>
</span><span class='line'>  &lt;tr>
</span><span class='line'>    &lt;td>&lt;%= post.name %>&lt;/td>
</span><span class='line'>    &lt;td>&lt;%= post.string %>&lt;/td>
</span><span class='line'>    &lt;td>&lt;%= post.title %>&lt;/td>
</span><span class='line'>    &lt;td>&lt;%= post.string %>&lt;/td>
</span><span class='line'>    &lt;td>&lt;%= post.content %>&lt;/td>
</span><span class='line'>    &lt;td>&lt;%= post.text %>&lt;/td>
</span><span class='line'>    &lt;td>&lt;%= link_to 'Show', post %>&lt;/td>
</span><span class='line'>    &lt;td>&lt;%= link_to 'Edit', edit_post_path(post) %>&lt;/td>
</span><span class='line'>    &lt;td>&lt;%= link_to 'Destroy', post, method: :delete, data: { confirm: 'Are you sure?' } %>&lt;/td>
</span><span class='line'>  &lt;/tr>
</span><span class='line'>&lt;% end %>
</span><span class='line'>&lt;/table>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;br />
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;p>&lt;%= link_to 'New Post', new_post_path %></span></code></pre></td></tr></table></div></figure></notextile></div></p>

<ul>
<li><p>定制Layout的版型：
<code>layouts</code>使用来包裹<code>views</code>的。app/views/layouts/application.html.erb定制输出的样式。</p></li>
<li><p>新建文档：：
app/views/posts/new.html.erb</p></li>
</ul>


<p>&lt;%= render 'form' =%>是第一次遇到<code>partials</code>。<code>partials</code>是一个HTML和Ruby的代码片段。可以在其他地方重复使用。</p>

<p>表单内容在 views/posts/<em>form.html.erb</em> 档案中。</p>

<ul>
<li>好吧， 下面是一些功能的实现， 我需要好好静下心来看一看。</li>
</ul>


<p><a href="http://guides.rubyonrails.org/getting_started.html">RailsGuides English</a></p>
]]></content>
  </entry>
  
</feed>
